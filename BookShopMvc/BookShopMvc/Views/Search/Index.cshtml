@using Microsoft.AspNetCore.Http
@using Microsoft.AspNetCore.Identity
@model IEnumerable<Product>
@{
    var httpContext = ViewContext.HttpContext;
    var searchQuery = httpContext.Request.Query["search"].ToString();
}
@inject UserManager<AppUser> UserManager
@{
    var user = await UserManager.GetUserAsync(User);
    var isUser = false;
    if (user != null)
    {
        isUser = await UserManager.IsInRoleAsync(user, "User");
    }
}
<div class="container">
    <div class="row">
        @Html.Partial("_SidebarDetailPartial")
        <div class="col-9">
            <!-- list book -->
            <div class="list-book">
                <div class="list-book-top d-flex justify-content-between align-items-center">
                    <h3>Kết quả tìm kiếm: @searchQuery</h3>
                </div>
                <div class="row justify-content-evenly">

                    @foreach (var product in Model)
                    {
                        <div class="col-6">

                            <div class="item bg-light d-flex justify-content-between shadow-sm p-3 mb-5 bg-body rounded" style="height: 250px;">
                                <!-- images cart item -->
                                <div class="images-item-book">
                                    <img src="~/backend/images/Product/@product.Thumb" alt="">
                                </div>
                                <!-- end -->
                                <!-- content item book -->
                                <div class="content-item-book d-flex flex-column justify-content-around ">
                                    <p class="title-item-book"><a class="text-decoration-none title-item-book" style="color: black" asp-action="Index" asp-controller="Product" asp-route-Id="@product.Id">@product.Name</a></p>
                                    <p class="des-item-book"><span>Lĩnh vực: </span><a href="">@product.Subcategory.Name</a></p>
                                    <p class="des-item-book"><span>Tác giả: </span> <a href="">@product.Author.Name</a></p>
                                    <ul class="rate-item-book d-flex justify-content-between">
                                        <li><span>&#9733;</span></li>
                                        <li><span>&#9733;</span></li>
                                        <li><span>&#9733;</span></li>
                                        <li><span>&#9733;</span></li>
                                        <li><span>&#9733;</span></li>
                                    </ul>
                                    <p class="des-item-book"><span>Price:</span><span class="price-book">@product.Price đ</span></p>
                                    <div class="item-book-user d-flex justify-content-between align-items-center">
                                        @if (User.Identity.IsAuthenticated && isUser)
                                        {
                                            <span class="add-cart" style="cursor:pointer">Add to cart</span>
                                            <span class="heart" style="cursor:pointer"><i class="fa-solid fa-heart"></i></span>
                                        }
                                        else
                                        {
                                            <span class="add-cart nologin" style="cursor:pointer">Add to cart</span>
                                            <span class="heart" style="cursor:pointer"><i class="fa-solid fa-heart nologin"></i></span>
                                        }
                                    </div>
                                </div>
                                <!-- end -->
                            </div>

                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>