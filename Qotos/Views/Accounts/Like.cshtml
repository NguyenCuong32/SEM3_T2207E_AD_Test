@model IEnumerable<Qotos.Models.Like>
@using Microsoft.AspNetCore.Identity
@inject SignInManager<AppUser> SignInManager
@inject UserManager<AppUser> UserManager

@{
	Layout = "_Layout";
	ViewData["Title"] = "Hồ sơ cá nhân";
	string userId = UserManager.GetUserId(User);
	var data = ViewData["Data"] as dynamic;
	var photosCount = data.PhotosCount;
	var likesCount = data?.LikesCount;
	var collectionsCount = data?.CollectionsCount;
	var accountUserName = data?.AccountUserName;
	var accountDescription = data?.AccountDescription;
	var accountThumbnail = data?.AccountThumbnail;
	var accountId = data?.AccountId;

}

<div class="d-flex container justify-content-center my-5 pt-5">
	<img style="width: 150px; height: 150px; object-fit: cover" class="rounded-circle" src="@accountThumbnail" alt="" />
	<div class="ms-5">
		<div class="d-flex align-items-center">
			<h1>@accountUserName</h1>
			@if (String.Equals(accountId, userId))
			{
				<a class="btn btn-outline-secondary ms-3" asp-action="info" asp-controller="accounts">
					<i class="bi bi-pencil-square"></i> Cài đặt tài khoản
				</a>
			}
		</div>
		<div>@accountDescription</div>
	</div>
</div>
<div class="w-100">
	<ul class="nav nav-underline border-bottom px-3">
		<li class="nav-item">
			<a class="nav-link text-secondary" aria-current="page" asp-action="profile" asp-controller="accounts"><i
					class="bi bi-image"></i> Ảnh @photosCount</a>
		</li>
		<li class="nav-item">
			<a class="nav-link active" asp-action="like" asp-controller="accounts"><i class="bi bi-heart-fill"></i> Thích
				@likesCount</a>
		</li>
		<li class="nav-item">
			<a class="nav-link text-secondary" asp-action="collection" asp-controller="accounts"><i class="bi bi-images">
				</i>Albums @collectionsCount</a>
		</li>
	</ul>
</div>
<div class="container my-5 pb-4">
	<div class="row">
		@if (Model.Count() == 0)
		{
			<div class="text-center">
				<img src="https://unsplash-assets.imgix.net/empty-states/photos.png?auto=format&fit=crop&q=60" alt=""
					class="w-25">
			</div>
		}
		else
		{
			@foreach (var item in Model)
			{
				<div class="col-4 my-3">
					<div class="card">
						<a class="p-3 text-decoration-none link-dark" href="/accounts/&#64;@item.User.UserName/profile">
							<img style="width: 32px; height: 32px; object-fit: cover" class="rounded-circle" src="@item.User.Thumbnail"
								alt="" />
							<span class="fw-bold">@item.User.UserName</span>
						</a>
						<img class="card-img-top btn-view" src="@item.Photo.Thumbnail" alt="Card image" style="cursor: zoom-in;"
							data-bs-toggle="modal" data-bs-target="#viewPictureModal" data-url="/photos/view/@item.Photo.Id" />
						<div class="card-body d-flex">
							<button class="btn btn-outline-danger me-2 btn-like" data-url="/photos/like/@item.Photo.Id">
								<i class="bi bi-heart-fill"></i>
							</button>
							<button class="btn btn-outline-secondary me-auto btn-collection" data-url="@item.Photo.Id"><i
									class="bi bi-plus-square"></i></button>
							<button class="btn btn-outline-secondary btn-download" data-url="/photos/download/@item.Photo.Id"><i
									class="bi bi-download"></i> Download</button>
						</div>
					</div>
				</div>
			}
		}
	</div>
</div>

@section js {
	<script>
		let userId = '@userId';
	</script>
}
